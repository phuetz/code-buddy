<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 600" font-family="'Segoe UI', Arial, sans-serif">
  <defs>
    <linearGradient id="highPriorityGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#48bb78"/>
      <stop offset="100%" style="stop-color:#276749"/>
    </linearGradient>
    <linearGradient id="medPriorityGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ecc94b"/>
      <stop offset="100%" style="stop-color:#d69e2e"/>
    </linearGradient>
    <linearGradient id="lowPriorityGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fc8181"/>
      <stop offset="100%" style="stop-color:#c53030"/>
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowComp" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4a5568"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="950" height="600" fill="#0f0f23"/>

  <!-- Title -->
  <text x="475" y="40" text-anchor="middle" fill="white" font-size="26" font-weight="bold">
    Compression Intelligente du Contexte
  </text>
  <text x="475" y="68" text-anchor="middle" fill="#718096" font-size="14">
    Garder l'essentiel quand le contexte dépasse la limite du modèle
  </text>

  <!-- Before compression (Left side) -->
  <g transform="translate(50, 100)">
    <text x="200" y="0" text-anchor="middle" fill="#fc8181" font-size="16" font-weight="bold">AVANT</text>
    <text x="200" y="20" text-anchor="middle" fill="#718096" font-size="11">180K tokens (> 128K limite)</text>

    <rect x="0" y="35" width="400" height="400" rx="10" fill="#1a1a3a" stroke="#fc8181" stroke-width="3" filter="url(#shadow)"/>

    <!-- Stacked content blocks -->
    <g transform="translate(15, 50)">
      <rect x="0" y="0" width="370" height="35" rx="5" fill="#2d3748"/>
      <text x="185" y="22" text-anchor="middle" fill="#48bb78" font-size="11" font-weight="bold">System Prompt (2K)</text>
    </g>

    <g transform="translate(15, 95)">
      <rect x="0" y="0" width="370" height="35" rx="5" fill="#2d3748"/>
      <text x="185" y="22" text-anchor="middle" fill="#48bb78" font-size="11" font-weight="bold">Message utilisateur actuel (500)</text>
    </g>

    <g transform="translate(15, 140)">
      <rect x="0" y="0" width="370" height="50" rx="5" fill="#2d3748"/>
      <text x="185" y="22" text-anchor="middle" fill="#ecc94b" font-size="11">Code en cours d'édition (8K)</text>
      <text x="185" y="40" text-anchor="middle" fill="#718096" font-size="9">grok-agent.ts, tools.ts</text>
    </g>

    <g transform="translate(15, 200)">
      <rect x="0" y="0" width="370" height="60" rx="5" fill="#2d3748"/>
      <text x="185" y="22" text-anchor="middle" fill="#ecc94b" font-size="11">Historique récent (15K)</text>
      <text x="185" y="40" text-anchor="middle" fill="#718096" font-size="9">10 derniers messages</text>
    </g>

    <g transform="translate(15, 270)">
      <rect x="0" y="0" width="370" height="50" rx="5" fill="#2d3748"/>
      <text x="185" y="22" text-anchor="middle" fill="#fc8181" font-size="11">Historique ancien (45K)</text>
      <text x="185" y="40" text-anchor="middle" fill="#718096" font-size="9">Messages du début de session</text>
    </g>

    <g transform="translate(15, 330)">
      <rect x="0" y="0" width="370" height="50" rx="5" fill="#2d3748"/>
      <text x="185" y="22" text-anchor="middle" fill="#fc8181" font-size="11">Documentation (70K)</text>
      <text x="185" y="40" text-anchor="middle" fill="#718096" font-size="9">README, API docs, guides...</text>
    </g>

    <g transform="translate(15, 390)">
      <rect x="0" y="0" width="370" height="30" rx="5" fill="#2d3748"/>
      <text x="185" y="19" text-anchor="middle" fill="#fc8181" font-size="11">Fichiers non liés (40K)</text>
    </g>

    <!-- Overflow indicator -->
    <g transform="translate(310, 445)">
      <rect x="0" y="0" width="90" height="25" rx="5" fill="#c53030"/>
      <text x="45" y="17" text-anchor="middle" fill="white" font-size="10" font-weight="bold">OVERFLOW!</text>
    </g>
  </g>

  <!-- Arrow -->
  <g transform="translate(470, 300)">
    <path d="M0 0 L60 0" stroke="#ffd700" stroke-width="4" marker-end="url(#arrowComp)"/>
    <text x="30" y="-10" text-anchor="middle" fill="#ffd700" font-size="12" font-weight="bold">Compression</text>
  </g>

  <!-- After compression (Right side) -->
  <g transform="translate(550, 100)">
    <text x="175" y="0" text-anchor="middle" fill="#48bb78" font-size="16" font-weight="bold">APRÈS</text>
    <text x="175" y="20" text-anchor="middle" fill="#718096" font-size="11">85K tokens (< 128K limite)</text>

    <rect x="0" y="35" width="350" height="320" rx="10" fill="#1a1a3a" stroke="#48bb78" stroke-width="3" filter="url(#shadow)"/>

    <!-- Compressed content -->
    <g transform="translate(15, 50)">
      <rect x="0" y="0" width="320" height="35" rx="5" fill="url(#highPriorityGrad)"/>
      <text x="160" y="22" text-anchor="middle" fill="white" font-size="11" font-weight="bold">System Prompt (2K) GARDÉ</text>
    </g>

    <g transform="translate(15, 95)">
      <rect x="0" y="0" width="320" height="35" rx="5" fill="url(#highPriorityGrad)"/>
      <text x="160" y="22" text-anchor="middle" fill="white" font-size="11" font-weight="bold">Message actuel (500) GARDÉ</text>
    </g>

    <g transform="translate(15, 140)">
      <rect x="0" y="0" width="320" height="50" rx="5" fill="url(#highPriorityGrad)"/>
      <text x="160" y="22" text-anchor="middle" fill="white" font-size="11" font-weight="bold">Code édition (8K) GARDÉ</text>
      <text x="160" y="40" text-anchor="middle" fill="rgba(255,255,255,0.7)" font-size="9">Priorité haute - essentiel</text>
    </g>

    <g transform="translate(15, 200)">
      <rect x="0" y="0" width="320" height="50" rx="5" fill="url(#medPriorityGrad)"/>
      <text x="160" y="22" text-anchor="middle" fill="white" font-size="11" font-weight="bold">Historique récent (10K) RÉSUMÉ</text>
      <text x="160" y="40" text-anchor="middle" fill="rgba(255,255,255,0.7)" font-size="9">15K → 10K par résumé LLM</text>
    </g>

    <g transform="translate(15, 260)">
      <rect x="0" y="0" width="320" height="40" rx="5" fill="url(#medPriorityGrad)"/>
      <text x="160" y="16" text-anchor="middle" fill="white" font-size="11" font-weight="bold">Contexte résumé (5K)</text>
      <text x="160" y="32" text-anchor="middle" fill="rgba(255,255,255,0.7)" font-size="9">Fusion docs + ancien historique</text>
    </g>

    <!-- Removed indicator -->
    <g transform="translate(15, 310)">
      <rect x="0" y="0" width="320" height="35" rx="5" fill="#2d3748" stroke="#fc8181" stroke-width="1" stroke-dasharray="5,3"/>
      <text x="160" y="22" text-anchor="middle" fill="#fc8181" font-size="11">❌ Supprimé: fichiers non liés</text>
    </g>
  </g>

  <!-- Priority legend -->
  <g transform="translate(550, 470)">
    <rect x="0" y="0" width="350" height="100" rx="10" fill="#1a1a3a" stroke="#4a5568" stroke-width="2"/>
    <text x="175" y="25" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="bold">Priorités de Compression</text>

    <g transform="translate(20, 40)">
      <rect x="0" y="0" width="80" height="18" rx="4" fill="url(#highPriorityGrad)"/>
      <text x="40" y="13" text-anchor="middle" fill="white" font-size="9">HAUTE</text>
      <text x="100" y="13" fill="#a0aec0" font-size="9">Garder tel quel</text>
    </g>

    <g transform="translate(20, 60)">
      <rect x="0" y="0" width="80" height="18" rx="4" fill="url(#medPriorityGrad)"/>
      <text x="40" y="13" text-anchor="middle" fill="white" font-size="9">MOYENNE</text>
      <text x="100" y="13" fill="#a0aec0" font-size="9">Résumer</text>
    </g>

    <g transform="translate(180, 40)">
      <rect x="0" y="0" width="80" height="18" rx="4" fill="url(#lowPriorityGrad)"/>
      <text x="40" y="13" text-anchor="middle" fill="white" font-size="9">BASSE</text>
      <text x="100" y="13" fill="#a0aec0" font-size="9">Supprimer</text>
    </g>

    <text x="175" y="90" text-anchor="middle" fill="#718096" font-size="10" font-style="italic">JetBrains 2024: -7% coûts, +2.6% succès</text>
  </g>
</svg>
